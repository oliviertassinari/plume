<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF51 SDK: Software controlled SPI Master driver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF51 SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a01034.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Software controlled SPI Master driver<div class="ingroups"><a class="el" href="a01253.html">Peripheral Drivers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Software controlled SPI Master driver.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga75239783245d73edd0e4fb4cab5fa27b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01034.html#ga75239783245d73edd0e4fb4cab5fa27b">SPIFrequency_t</a> { <br/>
&#160;&#160;<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27bad10d2d6d455c26fee9a98815334c3d47">Freq_125Kbps</a> = 0, 
<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27baa53819c1142a53ecc3b6a7982d1d158a">Freq_250Kbps</a>, 
<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27ba6285681e23ab15c5349f563158e1b616">Freq_500Kbps</a>, 
<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27ba2a2313f0090b5c125880296f4461f60c">Freq_1Mbps</a>, 
<br/>
&#160;&#160;<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27ba425990fcb3ee3d42eaa47deeb0223a87">Freq_2Mbps</a>, 
<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27ba4aba21b81e2a3d4d4247300e58e8b10e">Freq_4Mbps</a>, 
<a class="el" href="a01034.html#gga75239783245d73edd0e4fb4cab5fa27ba038c2e8494738bacb35f6c0814e60e1a">Freq_8Mbps</a>
<br/>
 }</td></tr>
<tr class="separator:ga75239783245d73edd0e4fb4cab5fa27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac859abd9dbf0e642ef29753f142f4475"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01034.html#gac859abd9dbf0e642ef29753f142f4475">SPIModuleNumber</a> { <a class="el" href="a01034.html#ggac859abd9dbf0e642ef29753f142f4475a7add1e0588a075d9385b10fcbb2010f4">SPI0</a> = 0, 
<a class="el" href="a01034.html#ggac859abd9dbf0e642ef29753f142f4475add83ddb396fbcb33f2d61248e5c4a185">SPI1</a>
 }</td></tr>
<tr class="separator:gac859abd9dbf0e642ef29753f142f4475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga96e7e9bbfca8b326307e8b20ba4706e1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01034.html#ga96e7e9bbfca8b326307e8b20ba4706e1">SPIMode</a> { <a class="el" href="a01034.html#gga96e7e9bbfca8b326307e8b20ba4706e1aacf2eef6aadb9f0de11862660cd9ade6">SPI_MODE0</a> = 0, 
<a class="el" href="a01034.html#gga96e7e9bbfca8b326307e8b20ba4706e1abd92ab028fcac05cf2ed27b4838d1590">SPI_MODE1</a>, 
<a class="el" href="a01034.html#gga96e7e9bbfca8b326307e8b20ba4706e1a2607e91fc0c8ae3334284808d7f94cf5">SPI_MODE2</a>, 
<a class="el" href="a01034.html#gga96e7e9bbfca8b326307e8b20ba4706e1ad9636eac0759655110aa77dd6c22da6c">SPI_MODE3</a>
 }</td></tr>
<tr class="separator:ga96e7e9bbfca8b326307e8b20ba4706e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac83edc688197ced911cf822ab3eae81a"><td class="memItemLeft" align="right" valign="top">uint32_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01034.html#gac83edc688197ced911cf822ab3eae81a">spi_master_init</a> (<a class="el" href="a01034.html#gac859abd9dbf0e642ef29753f142f4475">SPIModuleNumber</a> module_number, <a class="el" href="a01034.html#ga96e7e9bbfca8b326307e8b20ba4706e1">SPIMode</a> mode, bool lsb_first)</td></tr>
<tr class="memdesc:gac83edc688197ced911cf822ab3eae81a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for initializing given SPI master with given configuration.  <a href="#gac83edc688197ced911cf822ab3eae81a">More...</a><br/></td></tr>
<tr class="separator:gac83edc688197ced911cf822ab3eae81a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14655d328261ceeb3c23c73f6ae33980"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01034.html#ga14655d328261ceeb3c23c73f6ae33980">spi_master_tx_rx</a> (uint32_t *spi_base_address, uint16_t transfer_size, const uint8_t *tx_data, uint8_t *rx_data)</td></tr>
<tr class="memdesc:ga14655d328261ceeb3c23c73f6ae33980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function for transferring/receiving data over SPI bus.  <a href="#ga14655d328261ceeb3c23c73f6ae33980">More...</a><br/></td></tr>
<tr class="separator:ga14655d328261ceeb3c23c73f6ae33980"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Software controlled SPI Master driver. </p>
<p>Supported features:</p>
<ul>
<li>Operate two SPI masters independently or in parallel.</li>
<li>Transmit and Receive given size of data through SPI.</li>
<li>configure each SPI module separately through <a class="el" href="a00094.html#spi_master_init">SPI Module Initialization and Configuration</a>. </li>
</ul>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga75239783245d73edd0e4fb4cab5fa27b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a01034.html#ga75239783245d73edd0e4fb4cab5fa27b">SPIFrequency_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SPI master operating frequency </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27bad10d2d6d455c26fee9a98815334c3d47"></a>Freq_125Kbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 125Kbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27baa53819c1142a53ecc3b6a7982d1d158a"></a>Freq_250Kbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 250Kbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27ba6285681e23ab15c5349f563158e1b616"></a>Freq_500Kbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 500Kbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27ba2a2313f0090b5c125880296f4461f60c"></a>Freq_1Mbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 1Mbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27ba425990fcb3ee3d42eaa47deeb0223a87"></a>Freq_2Mbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 2Mbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27ba4aba21b81e2a3d4d4247300e58e8b10e"></a>Freq_4Mbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 4Mbps </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga75239783245d73edd0e4fb4cab5fa27ba038c2e8494738bacb35f6c0814e60e1a"></a>Freq_8Mbps</em>&nbsp;</td><td class="fielddoc">
<p>drive SClk with frequency 8Mbps </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="ga96e7e9bbfca8b326307e8b20ba4706e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a01034.html#ga96e7e9bbfca8b326307e8b20ba4706e1">SPIMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SPI mode </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga96e7e9bbfca8b326307e8b20ba4706e1aacf2eef6aadb9f0de11862660cd9ade6"></a>SPI_MODE0</em>&nbsp;</td><td class="fielddoc">
<p>Sample data at rising edge of clock and shift serial data at falling edge </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga96e7e9bbfca8b326307e8b20ba4706e1abd92ab028fcac05cf2ed27b4838d1590"></a>SPI_MODE1</em>&nbsp;</td><td class="fielddoc">
<p>sample data at falling edge of clock and shift serial data at rising edge </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga96e7e9bbfca8b326307e8b20ba4706e1a2607e91fc0c8ae3334284808d7f94cf5"></a>SPI_MODE2</em>&nbsp;</td><td class="fielddoc">
<p>sample data at falling edge of clock and shift serial data at rising edge </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga96e7e9bbfca8b326307e8b20ba4706e1ad9636eac0759655110aa77dd6c22da6c"></a>SPI_MODE3</em>&nbsp;</td><td class="fielddoc">
<p>Sample data at rising edge of clock and shift serial data at falling edge </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="gac859abd9dbf0e642ef29753f142f4475"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="a01034.html#gac859abd9dbf0e642ef29753f142f4475">SPIModuleNumber</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SPI master module number </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ggac859abd9dbf0e642ef29753f142f4475a7add1e0588a075d9385b10fcbb2010f4"></a>SPI0</em>&nbsp;</td><td class="fielddoc">
<p>SPI module 0 </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ggac859abd9dbf0e642ef29753f142f4475add83ddb396fbcb33f2d61248e5c4a185"></a>SPI1</em>&nbsp;</td><td class="fielddoc">
<p>SPI module 1 </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gac83edc688197ced911cf822ab3eae81a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t* spi_master_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a01034.html#gac859abd9dbf0e642ef29753f142f4475">SPIModuleNumber</a>&#160;</td>
          <td class="paramname"><em>module_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a01034.html#ga96e7e9bbfca8b326307e8b20ba4706e1">SPIMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>lsb_first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for initializing given SPI master with given configuration. </p>
<p>After initializing the given SPI master with given configuration, this function also test if the SPI slave is responding with the configurations by transmitting few test bytes. If the slave did not respond then error is returned and contents of the rx_data are invalid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">module_number</td><td>SPI master number (SPIModuleNumber) to initialize. </td></tr>
    <tr><td class="paramname">mode</td><td>SPI master mode (mode 0, 1, 2 or 3 from SPIMode) </td></tr>
    <tr><td class="paramname">lsb_first</td><td>true if lsb is first bit to shift in/out as serial data on MISO/MOSI pins. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">pointer</td><td>to direct physical address of the requested SPI module if init was successful </td></tr>
    <tr><td class="paramname">0,if</td><td>either init failed or slave did not respond to the test transfer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga14655d328261ceeb3c23c73f6ae33980"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spi_master_tx_rx </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>spi_base_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>transfer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>tx_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>rx_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function for transferring/receiving data over SPI bus. </p>
<p>If TWI master detects even one NACK from the slave or timeout occurs, STOP condition is issued and the function returns false.</p>
<dl class="section note"><dt>Note</dt><dd>Make sure at least transfer_size number of bytes is allocated in tx_data/rx_data.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi_base_address</td><td>register base address of the selected SPI master module </td></tr>
    <tr><td class="paramname">transfer_size</td><td>number of bytes to transmit/receive over SPI master </td></tr>
    <tr><td class="paramname">tx_data</td><td>pointer to the data that needs to be transmitted </td></tr>
    <tr><td class="paramname">rx_data</td><td>pointer to the data that needs to be received </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>if transmit/reveive of transfer_size were completed. </td></tr>
    <tr><td class="paramname">false</td><td>if transmit/reveive of transfer_size were not complete and tx_data/rx_data points to invalid data. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Mar 13 2014 14:27:19 for nRF51 SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
